<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Code Driven Infrastructure and Deployment</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="node_modules/normalize.css/normalize.css">
    <link rel="stylesheet" href="css/doc.css">
    <script src="node_modules/jquery/dist/jquery.min.js"></script>
    <script src="js/doc.js"></script>
</head>
<body>

<div class="front">

<p>
ZHAW Zurich University of Applied Sciences<br/>
Bachelor's degree programme Computer Science<br/>
Bachelor Thesis
</p>
<h1>Code Driven Infrastructure and&nbsp;Deployment</h1>
<p>
Author: Fabian Vogler, <a href="mailto:fabian.vogler@gmail.com">fabian.vogler@gmail.com</a><br/>
Advisor: Beat Seeliger<br/>
Co-Advisor: Silvan Spross<br/>
<span class="version">2015-07-31, Version 0.9<span id="version-build"></span></span>
</p>

</div>

<div class="chapter">

<p>
This thesis was done as part of a bachelor's degree study at ZHAW Zurich University of Applied Sciences in Zurich. The source code of this document is
available online at
<a href="https://github.com/fabian/bachelor-thesis">https://github.com/fabian/bachelor-thesis</a>.
</p>

<p>
This document has been written in HTML and was converted into a PDF document
with <a href="http://www.princexml.com/">Prince XML</a>. The font used is 
<em>Helvetica Neue</em>, created by D.&nbsp;Stempel&nbsp;AG and based on 
<em>Helvetica</em> by Max Miedinger.
</p>

<p>
All sources are numbered [<em>n</em>] and listed in the bibliography in the
appendix. Basic knowledge in computer science is required for reading and
understanding the thesis. The most important acronyms and concepts are 
explained in the glossary that can be found in the appendix as well.
</p>

</div>


<div class="chapter">

<h2 class="break nonr">Abstract</h2>

<p>
</p>

</div>


<div class="chapter">

<h2 class="break nonr">Contents</h2>
<ol id="toc"></ol>

</div>


<div class="chapter">

<h2 class="break">Introduction</h2>

<h3>Current Situation</h3>

<p>
WorldSkills International is a non-profit membership association which organizes
a world championship in skilled professions every two years. To manage members 
and to organize the preparation and execution of the competition the 
organization runs multiple web applications. The mix of PHP and Java 
applications consists of legacy systems and a newly developed software system 
with a service-oriented architecture.
</p>

<figure class="full">
<img src="images/application_screenshots.svg" />
<figcaption>Screenshots applications</figcaption>
</figure>

<p>
All web software is running on rented virtual servers running Linux. They are 
managed manually using a web control panel (Parallels Plesk). Changes to the 
infrastructure are done by one of the four internal software developers manually.
</p>

<p>
Fundamental changes like the migration to a new server or the switch to a new 
runtime engine require a lot of knowledge about the existing system and manual 
testing of the new installation.
</p>

<h3>Objectives</h3>

<p>
The main goal of this thesis is to develop a concept for a versioned, testable 
and reproducible infrastructure. Changes to the system should be visible for 
the IT team and traceable if needed. As a result knowledge is shared in written 
form.
</p>

<p>
To achieve this goal, manual steps to build or change the infrastructure should 
be replaced by code stored in a revision control system. Three different types 
of software for provisioning of servers and deployment exist at the moment:
</p>

<ul>
    <li>Software containers: all software needed to run an application is encapsulated and run in operating system-level virtualization (e.g. Docker, Rocket)</li>
    <li>Configuration repository: A centralized repository with configuration files and software is used to configure servers (e.g. Chef, Puppet, CFEngine)</li>
    <li>Remote command execution: Installation commands and configuration files are transmitted in a coordinated manner to a remote server (e.g. Ansible, Salt, Rex)</li>
</ul>

<p>
These types of software should be evaluated and an architecture documentation 
as well as a test concept should be written. The proposed architecture should 
then be tested in a proof-of-concept.
</p>

<h3>Tasks</h3>

<p>
The following tasks will be completed by the student as part of the Bachelor thesis:
</p>

<ol>
    <li>Analyze infrastructure requirements</li>
    <li>Test requirements with popular representatives for each type of provisioning software (Docker, Ansible, Chef)</li>
    <li>Evaluate provisioning software</li>
    <li>Write architecture documentation</li>
    <li>Develop test concept</li>
    <li>Implement proof-of-concept with automated provisioning and deployment</li>
</ol>

<h3>Project Management</h3>

<p>
The following gantt diagramm shows an overview of the timeline during the
project as well as the dates of the most important milestones.
</p>

<figure class="full">
<table>
    <colgroup>
        <col style="width: 180px;" />
        <col style="width: 21px;" />
        <col style="width: 21px;" />
        <col style="width: 21px;" />
        <col style="width: 21px;" />
        <col style="width: 21px;" />
        <col style="width: 21px;" />
        <col style="width: 21px;" />
        <col style="width: 21px;" />
        <col style="width: 21px;" />
        <col style="width: 21px;" />
        <col style="width: 21px;" />
        <col style="width: 21px;" />
        <col style="width: 21px;" />
        <col style="width: 21px;" />
        <col style="width: 21px;" />
        <col style="width: 21px;" />
        <col style="width: 21px;" />
        <col style="width: 21px;" />
        <col style="width: 21px;" />
        <col style="width: 21px;" />
        <col style="width: 21px;" />
        <col style="width: 21px;" />
        <col style="width: 21px;" />
        <col style="width: 21px;" />
    </colgroup>
    <thead>
        <tr>
            <th>&#160;</th>
            <th colspan="4">February</th>
            <th colspan="4">March</th>
            <th colspan="4">April</th>
            <th colspan="4">May</th>
            <th colspan="4">June</th>
            <th colspan="4">July</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Kick-Off</td>
            <td colspan="4" style="text-align: right;">25.02.15&nbsp;◆</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
        </tr>
        <tr>
            <td>Requirements analysis</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td colspan="4" style="background-color: #e8f0f8;">&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
        </tr>
        <tr>
            <td>Software evaluation</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td colspan="3" style="background-color: #e8f0f8;">&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
        </tr>
        <tr>
            <td>Design Review</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td colspan="4" style="border-left: 0;">◆&nbsp;XX.04.15</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
        </tr>
        <tr>
            <td>Architecture concept</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td colspan="6" style="background-color: #e8f0f8;">&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
        </tr>
        <tr>
            <td>Test concept</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td colspan="6" style="background-color: #e8f0f8;">&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
        </tr>
        <tr>
            <td>Proof-of-concept</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td colspan="3" style="background-color: #e8f0f8;">&#160;</td>
            <td>&#160;</td>
        </tr>
        <tr>
            <td>Final date</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td>&#160;</td>
            <td colspan="4" style="text-align: right;">31.07.15&nbsp;◆</td>
        </tr>
    </tbody>
</table>
<figcaption>Project schedule</figcaption>
</figure>

</div>


<div class="chapter">

<h2 class="break">Requirements</h2>

<h3>Overview</h3>

<p>
The following requirements were established by analysing the existing 
infrastrucutre and taking known problems into account.
</p>

<h3>Stakeholders</h3>

<p>
The following stakeholders have been found for the current infrastructure.
They have a direct or indirect influence on the requirements. Theses 
stakeholders are also used in the system context diagram.
</p>

<figure>
<table>
<colgroup>
    <col class="col-twenty" />
    <col />
</colgroup>
<tbody>
<tr>
<th>Stakeholder</th>
<th>Description</th>
</tr>
<tr>
<th>
Developer
</th>
<td>
Works at WorldSkills International and is responsible for the development and 
maintenance of the infrastructure. There are four developers working full-time 
for WorldSkills International, there is no designated system administrator. 
Developers have different backgrounds and therefor different knowledge about 
specific components of the instrastructure but they all share the 
responsibility for keeping the infrastructure running. They work from three 
different time zones.
</td>
</tr>
<tr>
<th>
User
</th>
<td>
Interacts with applications running on the WorldSkills infrastructure. This 
includes the Secretariat, Members, Competition personnel and website visitors. 
Most of them are registered users. Their expectations for fast and continiously 
running services influence the requirements.
</td>
</tr>
<tr>
<th>
Hoster
</th>
<td>
Provides virtual Linux servers for the infrastructure. As they are in a highly 
competitive and fast moving market they can become obsolete and need to be 
replaced with another hoster with a better offering.
</td>
</tr>
<tr>
<th>
GitHub
</th>
<td>
Hosts Git code repositories for WorldSkills International. Provides a web interface 
for managing permissions of the repositories. They control how code can be 
accessed.
</td>
</tr>
<tr>
<th>
Codeship
</th>
<td>
Provides a hosted continuous integration software for WorldSkills International.
The software is based on Linux with support for PHP, Java and JavaScript 
applications. Their functionality defines how applications can be built and 
deployed.
</td>
</tr>
</table>
<figcaption>Stakeholders</figcaption>
</figure>


<h3>System Context</h3>

<figure>
<img src="images/system-context.svg" />
<figcaption>System context</figcaption>
</figure>

<p>
Both Developer and User need to interact with the infrastructure or the 
applications running on it. They have a direct influence on the requirements 
and lie withing the system context.
</p>

<p>
The source code of most applications is stored on GitHub. Codeship is used for 
running automated tests and executing the deployment of new versions. The 
hoster provides the servers for running the infrastrucutre. All three
vendors influence the requirements indirectly with the constraints of their 
services. They are outside of the system context as they cannot be influenced.
</p>


<h3 class="break">Applications</h3>

<p>
The current infrastructure consists of multiple applications deployed on three 
servers. There is no requirement to keep them on separate servers. The 
following diagram gives an overview over all applications. A detailed 
description of each applications follows.
</p>

<figure>
<img src="images/overview.svg" />
<figcaption>System overview</figcaption>
</figure>

<p class="break">
The following table lists all applications and their special requirements.
</p>

<figure class="full">
<table>
<colgroup>
    <col class="col-twenty" />
    <col />
    <col />
    <col />
    <col />
    <col />
</colgroup>
<tbody>
<tr>
<th rowspan="2">Application</th>
<th rowspan="2">Description</th>
<th colspan="4">Requirements</th>
</tr>
<tr>
<th>RabbitMQ</th>
<th>MySQL</th>
<th>JavaMail</th>
<th>Uploads</th>
</tr>
<tr>
<th>
Web services
</th>
<td>
Java applications for managing organization information
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="Yes">
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="Yes">
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="Yes">
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="Yes">
</td>
</tr>
<tr>
<th>
Management
</th>
<td>
JavaScript applications for accessing the web services
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<th>
Auth
</th>
<td>
PHP application for login
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<th>
worldskills.org
</th>
<td>
Organization website
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="Yes">
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="Yes">
</td>
<td>
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="Yes">
</td>
</tr>
<tr>
<th>
WSC2015 website
</th>
<td>
WorldSkills São Paulo 2015 event website
</td>
<td>
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="Yes">
</td>
<td>
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="Yes">
</td>
</tr>
<tr>
<th>
WSC2017 website
</th>
<td>
WorldSkills Abu Dhabi 2017 event website
</td>
<td>
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="Yes">
</td>
<td>
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="Yes">
</td>
</tr>
<tr>
<th>
Members map
</th>
<td>
World map with Facebook pages from other countries
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<th>
IL
</th>
<td>
PHP application for managing infrastructure lists
</td>
<td>
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="Yes">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<th>
Aggregator
</th>
<td>
PHP application which serves the mobile app content
</td>
<td>
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="Yes">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<th>
Who-is-who
</th>
<td>
PHP application for managing organization personnel
</td>
<td>
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="Yes">
</td>
<td>
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="Yes">
</td>
</tr>
<tr>
<th>
Registrations
</th>
<td>
PHP application for registering people
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<th>
Forums
</th>
<td>
Dicussion forums
</td>
<td>
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="Yes">
</td>
<td>
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="Yes">
</td>
</tr>
<tr>
<th>
Portal
</th>
<td>
Website with information about Skills and Competitors
</td>
<td>
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="Yes">
</td>
<td>
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="Yes">
</td>
</tr>
<tr>
<th>
CIS demo
</th>
<td>
Competition Information System demo
</td>
<td>
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="Yes">
</td>
<td>
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="Yes">
</td>
</tr>
<tr>
<th>
Rooms
</th>
<td>
Java application for reserving meeting rooms
</td>
<td>
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="Yes">
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="Yes">
</td>
<td>
</td>
</tr>
<tr>
<th>
Archive
</th>
<td>
Static copies of old event websites
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<th>
Mailer
</th>
<td>
PHP application for sending emails to groups of people
</td>
<td>
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="Yes">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<th>
SMP
</th>
<td>
Skill Management Plan for planning the Skill competitions
</td>
<td>
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="Yes">
</td>
<td>
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="Yes">
</td>
</tr>
<tr>
<th>
CPT
</th>
<td>
Competition Planning Timetable with important deadlines
</td>
<td>
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="Yes">
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="Yes">
</td>
<td>
</td>
</tr>
</table>
<figcaption>Application requirements</figcaption>
</figure>


<h3 class="break">User Stories</h3>

<p>
To describe the functional requirements for the new infrastructure user stories 
are used. They are prioritized in agreement with all developers in three 
levels: Must, Should, Could.
</p>

<figure>
<table class="full">
<colgroup>
    <col class="col-twenty" />
    <col />
</colgroup>
<tbody>
<tr>
<th>RX</th>
<th>PHP applications</th>
</tr>
<tr>
<th>
Description
</th>
<td>
As a developer I want to run multiple PHP applications so users can access 
them. A PHP application usually needs a MySQL database and the source code 
is stored on GitHub.
</td>
</tr>
<tr>
<th>
Acceptance Criteria
</th>
<td>
All PHP applications are running and can be accessed with a web browser.
</td>
</tr>
<tr>
<th>Priority</th>
<td>Must</td>
</tr>
</table>
<figcaption>RX PHP applications</figcaption>
</figure>

<br/>

<figure>
<table class="full">
<colgroup>
    <col class="col-twenty" />
    <col />
</colgroup>
<tbody>
<tr>
<th>RX</th>
<th>Java applications</th>
</tr>
<tr>
<th>
Description
</th>
<td>
As a developer I want to run multiple Java applications on a Tomcat server so 
users and other applications can use the services provided bu the applications. 
A Java application usually needs a MySQL database, the source code is stored 
on GitHub.
</td>
</tr>
<tr>
<th>
Acceptance Criteria
</th>
<td>
All Java applications are running and can be accessed over HTTP.
</td>
</tr>
<tr>
<th>Priority</th>
<td>Must</td>
</tr>
</table>
<figcaption>RX Java applications</figcaption>
</figure>

<br/>

<figure>
<table class="full">
<colgroup>
    <col class="col-twenty" />
    <col />
</colgroup>
<tbody>
<tr>
<th>RX</th>
<th>Server configuration</th>
</tr>
<tr>
<th>
Description
</th>
<td>
As a developer I want to change a server configuration file to optimize a setting.
For example the MySQL Query Cache size needs to be increased. Another example 
would be that the servlet container configuration needs a new variable due to 
a change in the application.
</td>
</tr>
<tr>
<th>
Acceptance Criteria
</th>
<td>
A configuration file get modified and the change is pushed to the repository.
The new configuration file is automatically deployed to the server and the 
affected applications loads the new configuration.
</td>
</tr>
<tr>
<th>Priority</th>
<td>Must</td>
</tr>
</table>
<figcaption>RX Server configuration</figcaption>
</figure>

<br/>

<figure>
<table class="full">
<colgroup>
    <col class="col-twenty" />
    <col />
</colgroup>
<tbody>
<tr>
<th>RX</th>
<th>Application deployment</th>
</tr>
<tr>
<th>
Description
</th>
<td>
As a developer I want to deploy a new version of an application so users can 
benefit from new features or fixes. The deployment causes no downtime.
</td>
</tr>
<tr>
<th>
Acceptance Criteria
</th>
<td>
A new version of an application gets pushed to the repository. Automated tests 
of the application are executed and if they pass the application gets deployed 
to the server. The old version keeps responding to requests until the new 
version is ready.
</td>
</tr>
<tr>
<th>Priority</th>
<td>Should</td>
</tr>
</table>
<figcaption>RX Application deployment</figcaption>
</figure>

<br/>

<figure>
<table class="full">
<colgroup>
    <col class="col-twenty" />
    <col />
</colgroup>
<tbody>
<tr>
<th>RX</th>
<th>Staging Area</th>
</tr>
<tr>
<th>
Description
</th>
<td>
As a developer, I want to test a new version of a web service in a staging area
so I can make sure if works as expected.
</td>
</tr>
<tr>
<th>
Acceptance Criteria
</th>
<td>
A new version of a web service is pushed in a separate branch, the 
functionality is available for testing in a staging environment within 
10&nbsp;minutes from the push.
</td>
</tr>
<tr>
<th>Priority</th>
<td>Should</td>
</tr>
</table>
<figcaption>RX Staging Area</figcaption>
</figure>

<br/>

<figure>
<table class="full">
<colgroup>
    <col class="col-twenty" />
    <col />
</colgroup>
<tbody>
<tr>
<th>RX</th>
<th>Hoster switch</th>
</tr>
<tr>
<th>
Description
</th>
<td>
As a developer I want to switch the server hoster so I can profit from a better 
offer. Another reason could be that the current hoster shuts down or its no 
longer justifiable because of his actions (e.g. security problems).
</td>
</tr>
<tr>
<th>
Acceptance Criteria
</th>
<td>
The infrastructure can be ported to a different provider within 48 hours. All 
needed software is installed automatically, databases and user files are 
transfered manually.
</td>
</tr>
<tr>
<th>Priority</th>
<td>Could</td>
</tr>
</table>
<figcaption>RX Hoster switch</figcaption>
</figure>


<h3>Non-functional requirements</h3>

<p>
The following non-functional requirements are not conclusive but they are 
the most critical ones. They are classified according to quality model of 
ISO/IEC 25010:2011 and prioritized in three levels: Must, Should, Could.
</p>

<p>
The requirements are based on the current infrastructure and events in the past 
related to it.
</p>


<figure>
<table class="full">
<colgroup>
    <col class="col-twenty" />
    <col />
</colgroup>
<tbody>
<tr>
<th>RX</th>
<th>Configuration files</th>
</tr>
<tr>
<th>
Classification
</th>
<td>
Changeability
</td>
</tr>
<tr>
<th>
Description
</th>
<td>
All configuration files are stored in a code repository.
</td>
</tr>
<tr>
<th>Priority</th>
<td>Must</td>
</tr>
</table>
<figcaption>RX Configuration files</figcaption>
</figure>

<br/>

<figure>
<table class="full">
<colgroup>
    <col class="col-twenty" />
    <col />
</colgroup>
<tbody>
<tr>
<th>RX</th>
<th>Change history</th>
</tr>
<tr>
<th>
Classification
</th>
<td>
Accountability
</td>
</tr>
<tr>
<th>
Description
</th>
<td>
Every change must be traceable to a developer. Associated with every change is 
an explanation.
</td>
</tr>
<tr>
<th>Priority</th>
<td>Must</td>
</tr>
</table>
<figcaption>RX Change history</figcaption>
</figure>

<br/>

<figure>
<table class="full">
<colgroup>
    <col class="col-twenty" />
    <col />
</colgroup>
<tbody>
<tr>
<th>RX</th>
<th>Open Source</th>
</tr>
<tr>
<th>
Classification
</th>
<td>
Replaceability
</td>
</tr>
<tr>
<th>
Description
</th>
<td>
All software used for infrastructure has to be built on open-source software.
This guarantees that components can easily be ported to different providers 
or maintainers. It also allows other Members to easily copy parts of the 
infrastructure.
</td>
</tr>
<tr>
<th>Priority</th>
<td>Must</td>
</tr>
</table>
<figcaption>RX Open Source</figcaption>
</figure>

<br/>

<figure>
<table class="full">
<colgroup>
    <col class="col-twenty" />
    <col />
</colgroup>
<tbody>
<tr>
<th>RX</th>
<th>Test environment</th>
</tr>
<tr>
<th>
Classification
</th>
<td>
Testability
</td>
</tr>
<tr>
<th>
Description
</th>
<td>
To test configuration changes to it, the whole or part of the infrastructure 
can be started in a test environment.
</td>
</tr>
<tr>
<th>Priority</th>
<td>Must</td>
</tr>
</table>
<figcaption>RX Test environment</figcaption>
</figure>

<br/>

<figure>
<table class="full">
<colgroup>
    <col class="col-twenty" />
    <col />
</colgroup>
<tbody>
<tr>
<th>RX</th>
<th>Encrypted passwords</th>
</tr>
<tr>
<th>
Classification
</th>
<td>
Confidentiality
</td>
</tr>
<tr>
<th>
Description
</th>
<td>
Server passwords should be stored only encrypted on third-party systems.
</td>
</tr>
<tr>
<th>Priority</th>
<td>Must</td>
</tr>
</table>
<figcaption>RX Encrypted passwords</figcaption>
</figure>

<br/>

<figure>
<table class="full">
<colgroup>
    <col class="col-twenty" />
    <col />
</colgroup>
<tbody>
<tr>
<th>RX</th>
<th>Superuser access</th>
</tr>
<tr>
<th>
Classification
</th>
<td>
Technical accessibility
</td>
</tr>
<tr>
<th>
Description
</th>
<td>
In case of a problem that only occurs in a certain environment, a developer 
needs unrestricted access to the server to debug the error and try out 
different solutions.
</td>
</tr>
<tr>
<th>Priority</th>
<td>Must</td>
</tr>
</table>
<figcaption>RX Superuser access</figcaption>
</figure>

<br/>

<figure>
<table class="full">
<colgroup>
    <col class="col-twenty" />
    <col />
</colgroup>
<tbody>
<tr>
<th>RX</th>
<th>Custom software</th>
</tr>
<tr>
<th>
Classification
</th>
<td>
Interoperability
</td>
</tr>
<tr>
<th>
Description
</th>
<td>
New software can be installed without restrictions. New features or analytics 
tools might require the installation of additional software.
</td>
</tr>
<tr>
<th>Priority</th>
<td>Must</td>
</tr>
</table>
<figcaption>RX Custom software</figcaption>
</figure>

<br/>

<figure>
<table class="full">
<colgroup>
    <col class="col-twenty" />
    <col />
</colgroup>
<tbody>
<tr>
<th>RX</th>
<th>Horizontal scaling</th>
</tr>
<tr>
<th>
Classification
</th>
<td>
Changeability
</td>
</tr>
<tr>
<th>
Description
</th>
<td>
Applications that can be horizontally scaled can be installed on multiple 
servers and served through a load balancer.
</td>
</tr>
<tr>
<th>Priority</th>
<td>Could</td>
</tr>
</table>
<figcaption>RX Horizontal scaling</figcaption>
</figure>


</div>


<div class="chapter">

<h2 class="break">Evaluation</h2>

<h3>Introduction</h3>

<p>
Based on the given requirements the following evaluation defines the guiding 
principles for the architecture concept. It compares the different approaches 
for configuring and deploying software and how well they fit to the existing 
environment.
</p>

<p>
Only specific attributes of the approaches and their software is analyzed,
many general comparisons have been written before.
</p>

<p>
Cloud solutions for managing applications exist, but are usually locked in on 
the vendor and targeted at high volumes. Our scaling requirements are low as 
the infrastructure needs to serve mainly the Competition and the Members and 
they are both limited by other resources.
</p>


<h3>Software Containers</h3>

<p>
This type of software has recently became popular with Docker. The idea is to 
use the advantages of a virtual machine (isolation, portability, efficiency) 
while sharing resources. Docker has been chosen as it has been perceived as the 
most active project. A similar projects is Rocket by CoreOS.
</p>

<p>
Docker only works on Linux, so for development on Mac OS X the software 
Boot2Docker is used on the development laptop. Installation instructions are 
provided in the <a href="#ref-docker-docs">Docker documentation</a> in the 
chapter <em>Installation for Mac OS X</em>.
</p>

<p>
After the installation the virtual machine with the Linux running Docker 
is then launched with the following two commands.
</p>

<figure>
<pre><code>$ boot2docker init
$ boot2docker start
Waiting for VM and Docker daemon to start...
.............ooo
Started.
Writing /Users/fabian/.boot2docker/certs/boot2docker-vm/ca.pem
Writing /Users/fabian/.boot2docker/certs/boot2docker-vm/cert.pem
Writing /Users/fabian/.boot2docker/certs/boot2docker-vm/key.pem

To connect the Docker client to the Docker daemon, please set:
    export DOCKER_HOST=tcp://192.168.59.103:2376
    export DOCKER_CERT_PATH=/Users/fabian/.boot2docker/certs/boot2docker-vm
    export DOCKER_TLS_VERIFY=1
</code></pre>
<figcaption>Boot2Docker initialization</figcaption>
</figure>

<p>
Another useful tool is Docker Compose which allows multiple instances to be 
started based on a configuration file. However it's usage in production is not 
recommended at the moment as it's missing some features for managing managing 
running instances.
</p>

<h4>RX PHP applications</h4>

<p>
Docker publishes official images for certain applications and programming 
languages in the Docker Hub Repository. There's also an official image for PHP 
which can be found on <a href="#ref-docker-php">GitHub</a>. Maintained images 
for <a href="#ref-php-versions">recent PHP versions</a> are provided with 
built-in PHP-FPM or Apache for running the application as a service.
</p>

<p>
The easiest way to run a PHP application with Docker is to use Apache so the 
application itself and static files (JavaScript, CSS, etc.) can both be served 
from one process.
</p>

<p>
The MySQL server would be started in a separate instance, so an additional 
Dockerfile for MySQL is needed and then needs to be linked with the container 
running the PHP application. To simplify this Docker Compose can be used. It's 
a tool that can start multiple Docker instances based on a configuration file.
</p>

<p>
Verdict: Pass <img src="images/sign-check.svg" width="16" height="16" alt="">
</p>

<h4>RX Java applications</h4>

<p>
For Tomcat official images published are available from the Docker Hub 
Repository as well. Multiple versions with for Java 7 and 8 are available.
</p>

<p>
Configuration and the application code can be copied to the working directory 
of Tomcat and are read and started automatically. Multiple applications can be 
bundled into one container or one container per application can be used. Again 
as with PHP, a MySQL server would be started in a separate instance.
</p>

<p>
Verdict: Pass <img src="images/sign-check.svg" width="16" height="16" alt="">
</p>

<h4>RX Server configuration</h4>

<p>
To guarantee reproducable containers configuration files are usually copied 
into the container at build time. This allows the container to be tested in a 
staging environment and making guarantees the same result in the production 
environment.
</p>

<p>
Docker provides the tools to build the image and upload it to a central 
repository, however it doesn't provide any tools to do an actual deployment 
of the image to a live environment out of the box.
</p>

<p>
Verdict: Fail <img src="images/sign-error.svg" width="16" height="16" alt="">
</p>

<h4>RX Application deployment</h4>

<p>
There are different ways how to implement this with Docker. One way would be to 
build a new image, deploy it separatly and then route requests with a load 
balancer to the new image. However as noted before, Docker doesn't provide 
tools to do a deployment of the image nor to configure load balancing.
</p>

<p>
Another possibiliy would be to use volumes to deploy the new application into 
the running container but this would require each application to have built-in 
support for zero downtime deployment, which is not always the case (Tomcat 
supports this with parallel deployment but not PHP).
</p>

<p>
Verdict: Fail <img src="images/sign-error.svg" width="16" height="16" alt="">
</p>

<h4>RX Staging Area</h4>

<p>
Containers can easily be started quickly in a new environment (e.g. a new 
virtual server). Docker Compose can be used here for starting up multiple 
containers at once. Database fixtures can be loaded from additional containers 
which are linked to the database container.
</p>

<p>
Verdict: Pass <img src="images/sign-check.svg" width="16" height="16" alt="">
</p>

<h4>RX Hoster switch</h4>

<p>
Thanks to the virtualization the only requirement for a new hoster would be 
to run Docker. Transfer of the data is possible by launching additional 
containers on the old server and mounting the data volumes. However the 
installation of Docker would need to be done manually if the hoster doesn't 
provide preinstalled Docker. Configuration of the host machine could also not 
be automated with Docker.
</p>

<p>
Verdict: Fail <img src="images/sign-error.svg" width="16" height="16" alt="">
</p>

<h4>Summary</h4>

<figure>
<table class="full">
<colgroup>
    <col class="col-fifty" />
    <col class="col-fifty" />
</colgroup>
<tbody>
<tr>
<th>Advantages</th>
<th>Disadvantages</th>
</tr>
<tr>
<td>
<ul>
<li>Immutable applications</li>
<li>Active Docker community</li>
<li>Software can be updated for each container independently</li>
<li>Clear separation of concern</li>
<li>Can be scaled well horizontally</li>
</ul>
</td>
<td>
<ul>
<li>Added complexity</li>
<li>Additional virtualization layer makes debugging harder</li>
<li>New technology, still in development</li>
</ul>
</td>
</tr>
</table>
<figcaption>Summary Software Containers</figcaption>
</figure>

<ul>
</ul>

<h3>Configuration Repository</h3>

<h3>Remote Command Execution</h3>

<h3>Comparison</h3>

<figure class="full">
<table>
<colgroup>
    <col class="col-fifty" />
    <col />
    <col />
    <col />
</colgroup>
<tbody>
<tr>
<th>Requirement</th>
<th>Software Containers</th>
<th>Configuration Repository</th>
<th>Remote Command Execution</th>
</tr>
<tr>
<td>
RX PHP applications
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="">
</td>
<td>

</td>
<td>

</td>
</tr>
<tr>
<td>
RX Java applications
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="">
</td>
<td>

</td>
<td>

</td>
</tr>
<tr>
<td>
RX Server configuration
</td>
<td>
<img src="images/sign-error.svg" width="16" height="16" alt="">
</td>
<td>

</td>
<td>

</td>
</tr>
<tr>
<td>
RX Application deployment
</td>
<td>
<img src="images/sign-error.svg" width="16" height="16" alt="">
</td>
<td>

</td>
<td>

</td>
</tr>
<tr>
<td>
RX Staging Area
</td>
<td>
<img src="images/sign-check.svg" width="16" height="16" alt="">
</td>
<td>

</td>
<td>

</td>
</tr>
<tr>
<td>
RX Hoster switch
</td>
<td>
<img src="images/sign-error.svg" width="16" height="16" alt="">
</td>
<td>

</td>
<td>

</td>
</tr>
</table>
<figcaption>Requirements comparison</figcaption>
</figure>

<h3>Conclusion</h3>

<p>
Many advantages are not needed for a team of four developers but add 
additional complexity. Also quickly setting up a development environment is not 
as important as no new developers are expected to join the team within the 
next 4 years.
</p>

</div>


<div class="chapter">

<h2 class="break">Concept</h2>

<h3>Architecture</h3>

<h3>Deployment</h3>

<h3>Testing</h3>

<p>
</p>

</div>


<div class="chapter">

<h2 class="break">Implementation</h2>

<h3>Proof-of-concept</h3>

<h3>Test Results</h3>

<p>
</p>

</div>


<div class="chapter">

<h2 class="break">Conclusions</h2>

<p>
</p>

</div>


<div class="chapter">

<h2 class="break">Appendix</h2>


<h3>Bibliography</h3>

<p id="ref-docker-book" class="reference-item">
    <span class="ref">James Turnbull (2015): The Docker Book</span>. February 2015. Version&nbsp;v1.5.0.
    ISBN&nbsp;9780988820234.
</p>

<p id="ref-taste-test" class="reference-item">
    <span class="ref">Matt Jaynes (2014): Taste Test: Puppet, Chef, SaltStack, Ansible</span>. June 2014.
    <a href="https://devopsu.com/books/taste-test-puppet-chef-salt-stack-ansible.html" target="_blank">https://devopsu.com/books/taste-test-puppet-chef-salt-stack-ansible.html</a>
    (retrieved&nbsp;7.&nbsp;April&nbsp;2015)
</p>

<p id="ref-docker-docs" class="reference-item">
    <span class="ref">Docker, Inc. (2015): Docker Documentation</span>. Version&nbsp;v1.5
    <a href="https://docs.docker.com/v1.5/" target="_blank">https://docs.docker.com/v1.5/</a>
    (retrieved&nbsp;7.&nbsp;April&nbsp;2015)
</p>

<p id="ref-docker-php" class="reference-item">
    <span class="ref">Tianon Gravi (2015): Docker Official Image packaging for PHP</span>.
    <a href="https://github.com/docker-library/php" target="_blank">https://github.com/docker-library/php</a>
    (retrieved&nbsp;7.&nbsp;April&nbsp;2015)
</p>

<p id="ref-php-versions" class="reference-item">
    <span class="ref">The PHP Group (2015): PHP Supported Versions</span>.
    <a href="https://php.net/supported-versions.php" target="_blank">https://php.net/supported-versions.php</a>
    (retrieved&nbsp;7.&nbsp;April&nbsp;2015)
</p>


<h3 class="break">List of Figures</h3>

<ul id="figures"></ul>


<h3>Software</h3>

<p>
The make the results of this thesis reproducable, the following list shows the
version of the software used.
</p>

<ul>
<li>Mac OS X 10.10.2 Build 14C1514</li>
<li>Git 1.9.5</li>
<li>Boot2Docker 1.5.0 (Docker v1.5.0, Linux v3.18.5)</li>
<li>Docker Compose 1.1.0</li>
<li>VirtualBox 4.3.26 r98988</li>
<li>Tower 2.2.0 Build 274</li>
<li>Chocolat 3.1.4</li>
<li>Prince 9.0 rev 5</li>
</ul>

<h3 class="break">Glossary</h3>

<dl>
    <dt>Mac OS X</dt>
    <dd></dd>
    <dt>PHP-FPM</dt>
    <dd></dd>
</dl>

</div>


<footer>&#160;</footer>


</body>
</html>
